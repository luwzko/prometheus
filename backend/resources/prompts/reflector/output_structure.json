{
    "model": "{model_name}",
    "messages": [
        {"role": "system", "content": "{system_prompt}"},
        {"role": "assistant", "content": "{execution_results}"}
    ],
    "max_tokens": 4096,
    "temperature": 0.2,
    "response_format": {
        "type": "json_schema",
        "json_schema": {
            "name": "response",
            "strict": true,
            "schema": {
                "type": "object",
                "properties": {
                    "summary": {
                        "type": "string",
                        "description": "Final, concise summary of all steps, actions, and results performed for the user request."
                    },
                    "control": {
                        "type": "object",
                        "description": "Control fields for the reflector to evaluate whether previous actions succeeded or failed.",
                        "properties": {
                            "error_detected": {
                                "type": "boolean",
                                "description": "Set by the reflector: true if something went wrong in the analyzed actions, false otherwise."
                            },
                            "error_reason": {
                                "type": "string",
                                "description": "Optional human-readable explanation of what went wrong, if error_detected is true."
                            },
                            "recommended_action": {
                                "type": "string",
                                "description": "High-level recommendation for what the next step should do if an error is detected (e.g., 'retry', 'abort', 'fallback', 'ask_user')."
                            }
                        },
                        "required": ["error_detected"]
                    }
                },
                "required": ["summary", "control"]
            }
        }
    }
}
